<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Crop Recommendation System</title>
    <link rel="stylesheet" href="../static/css/tailwaind.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>Smart Crop Recommendation System</h1>
            <p class="subtitle">Get intelligent recommendations based on soil conditions or crop requirements</p>
        </div>
    </header>
    
    <main class="container">
        <!-- Welcome Section -->
        <section id="welcome-section" class="card">
            <h2>Welcome to Smart Crop Recommendation</h2>
            <p>Our system uses machine learning to help you make better farming decisions based on soil conditions. Please select one of the options below to get started:</p>
            
            <div class="welcome-options">
                <div class="option-card" onclick="showSection('soil-recommendation')">
                    <img src="../static/images/soil.jpeg" alt="Soil Icon" width="100" height="100">
                    <h3>Get Soil Recommendations</h3>
                    <p>Enter your desired crop, and we'll recommend the ideal soil conditions for optimal growth.</p>
                </div>
                
                <div class="option-card" onclick="showSection('crop-recommendation')">
                    <img src="../static/images/crop1.jpeg" alt="Crop Icon" width="100" height="100">
                    <h3>Find Suitable Crops</h3>
                    <p>Enter your soil test results, and we'll recommend the most suitable crops for your land.</p>
                </div>
            </div>
        </section>
        
        <!-- Soil Recommendation Form -->
        <section id="soil-recommendation-section" class="form-section card">
            <h2>Soil Recommendation for Crops</h2>
            <p>Please select a crop to get recommended soil conditions:</p>
            
            <form id="soil-recommendation-form">
                <div class="form-group">
                    <label for="crop-select">Select Crop:</label>
                    <select id="crop-select" required>
                        <option value="">-- Select a crop --</option>
                        <option value="rice">Rice</option>
                        <option value="wheat">Wheat</option>
                        <option value="maize">Maize</option>
                        <option value="chickpea">Chickpea</option>
                        <option value="kidney-beans">Kidney Beans</option>
                        <option value="pigeon-peas">Pigeon Peas</option>
                        <option value="moth-beans">Moth Beans</option>
                        <option value="mung-bean">Mung Bean</option>
                        <option value="black-gram">Black Gram</option>
                        <option value="lentil">Lentil</option>
                        <option value="pomegranate">Pomegranate</option>
                        <option value="banana">Banana</option>
                        <option value="mango">Mango</option>
                        <option value="grapes">Grapes</option>
                        <option value="watermelon">Watermelon</option>
                        <option value="muskmelon">Muskmelon</option>
                        <option value="apple">Apple</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <button type="button" class="back-btn" onclick="showSection('welcome')">Back</button>
                    <button type="button" onclick="getSoilRecommendation()">Get Recommendations</button>
                </div>
            </form>
            
            <!-- Results Section for Soil Recommendations -->
            <div id="soil-results" class="results-section" style="display:none;">
                <h3 class="results-title">Recommended Soil Conditions</h3>
                <table class="parameter-table">
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Ideal Value</th>
                            <th>Acceptable Range</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>pH Level</td>
                            <td id="ph-value">-</td>
                            <td>6.0 - 7.0</td>
                        </tr>
                        <tr>
                            <td>Electrical Conductivity (EC)</td>
                            <td id="ec-value">-</td>
                            <td>0.6 - 1.0</td>
                        </tr>
                        <tr>
                            <td>Nitrogen (N)</td>
                            <td id="n-value">-</td>
                            <td>100 - 140</td>
                        </tr>
                        <tr>
                            <td>Phosphorus (P)</td>
                            <td id="p-value">-</td>
                            <td>30 - 50</td>
                        </tr>
                        <tr>
                            <td>Potassium (K)</td>
                            <td id="k-value">-</td>
                            <td>60 - 100</td>
                        </tr>
                        <tr>
                            <td>Recommended Soil Texture</td>
                            <td id="texture-value">-</td>
                            <td>Sandy Loam to Clay Loam</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Crop Recommendation Form -->
        <section id="crop-recommendation-section" class="form-section card">
        
            
            <form id="crop-recommendation-form" class="crop-form">
  <h2 class="form-title">Crop Recommendation for Your Soil</h2>
  <p class="form-subtitle">Please enter your soil test results to get suitable crop recommendations:</p>

  <div class="form-row">
    <div class="form-group">
      <label for="ph-input">pH Level:</label>
      <input type="number" id="ph-input" name="ph" step="0.1" placeholder="e.g., 6.5" required>
    </div>

    <div class="form-group">
      <label for="ec-input">Electrical Conductivity (EC):</label>
      <input type="number" id="ec-input" name="ec" step="0.1" placeholder="e.g., 0.8" required>
    </div>
  </div>

  <div class="form-row">
    <div class="form-group">
      <label for="n-input">Nitrogen (N) in kg/ha:</label>
      <input type="number" id="n-input" name="n" placeholder="e.g., 120" required>
    </div>

    <div class="form-group">
      <label for="p-input">Phosphorus (P) in kg/ha:</label>
      <input type="number" id="p-input" name="p" placeholder="e.g., 40" required>
    </div>

    <div class="form-group">
      <label for="k-input">Potassium (K) in kg/ha:</label>
      <input type="number" id="k-input" name="k" placeholder="e.g., 80" required>
    </div>
  </div>

  <div class="form-group">
    <label for="soil-texture">Soil Texture:</label>
    <select id="soil-texture" name="soil_texture" required>
      <option value="">-- Select soil texture --</option>
      <option value="sandy">Sandy</option>
      <option value="loamy">Loamy</option>
      <option value="clayey">Clayey</option>
      <option value="silty">Silty</option>
    </select>
  </div>

  <div class="form-actions">
    <button type="button" class="back-btn" onclick="showSection('welcome')">Back</button>
    <button type="button" class="submit-btn" onclick="getCropRecommendation()">Get Recommendations</button>
  </div>
</form>


            <!-- Results Section for Crop Recommendations -->
            <div id="crop-results" class="results-section" style="display:none;">
                <h3 class="results-title">Recommended Crops</h3>
                <div id="crop-list"></div>
            </div>
        </section>
    </main>
    
    <footer class="container">
        <p>&copy; 2025 Smart Crop Recommendation System. All rights reserved.</p>
    </footer>
    
    <script>
    function showSection(sectionId) {
        document.getElementById('welcome-section').style.display = 'none';
        document.getElementById('soil-recommendation-section').style.display = 'none';
        document.getElementById('crop-recommendation-section').style.display = 'none';

        if (sectionId === 'welcome') {
            document.getElementById('welcome-section').style.display = 'block';
        } else if (sectionId === 'soil-recommendation') {
            document.getElementById('soil-recommendation-section').style.display = 'block';
        } else if (sectionId === 'crop-recommendation') {
            document.getElementById('crop-recommendation-section').style.display = 'block';
        }

        document.getElementById('soil-results').style.display = 'none';
        document.getElementById('crop-results').style.display = 'none';
    }

    async function getSoilRecommendation() {
        const cropSelect = document.getElementById('crop-select');
        if (cropSelect.value === '') {
            alert('Please select a crop to get recommendations');
            return;
        }

        const response = await fetch("/soil-recommendation", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: new URLSearchParams({ crop: cropSelect.value })
        });

        const data = await response.json();

        document.getElementById('ph-value').textContent = data.ph;
        document.getElementById('ec-value').textContent = data.ec;
        document.getElementById('n-value').textContent = data.n;
        document.getElementById('p-value').textContent = data.p;
        document.getElementById('k-value').textContent = data.k;
        document.getElementById('texture-value').textContent = data.texture;

        document.getElementById('soil-results').style.display = 'block';
    }

    async function getCropRecommendation() {
        const ph = document.getElementById('ph-input').value;
        const ec = document.getElementById('ec-input').value;
        const n = document.getElementById('n-input').value;
        const p = document.getElementById('p-input').value;
        const k = document.getElementById('k-input').value;
        const sand = document.getElementById('sand-input').value;
        const silt = document.getElementById('silt-input').value;
        const clay = document.getElementById('clay-input').value;

        if (!ph || !ec || !n || !p || !k || !sand || !silt || !clay) {
            alert('Please fill in all fields to get recommendations');
            return;
        }

        const response = await fetch("/crop-recommendation", {
            method: "POST",
            headers: { "Content-Type": "application/x-www-form-urlencoded" },
            body: new URLSearchParams({ ph, ec, n, p, k, sand, silt, clay })
        });

        const data = await response.json();

        const cropList = document.getElementById('crop-list');
        cropList.innerHTML = "";
        data.forEach(crop => {
            const div = document.createElement('div');
            div.classList.add('result-item');
            div.innerHTML = `<span class="crop-name">${crop.name}</span>
                             <span class="score">${crop.score}</span>`;
            cropList.appendChild(div);
        });

        document.getElementById('crop-results').style.display = 'block';
    }

    window.onload = function() {
        showSection('welcome');
    };
    </script>
</body>
</html>
